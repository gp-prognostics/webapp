<a
  href="https://discord.com/api/oauth2/authorize?client_id=1111955711665127535&redirect_uri=https%3A%2F%2Fbeta.gp-prognostics.fr%2Flogin%2F&response_type=code&scope=identify"
>
  <button>Login with discord</button>
</a>

<script>
  var url = new URL(window.location.href);
  var code = url.searchParams.get("code");
  if (code != null) {
    const url =
      "https://beta.gp-prognostics.fr/api/discord/login/?code=" + code;

    fetch(url)
      .then((response) => {
        return response.json();
      })
      .then((data) => {
        if (data.status === "success") {
          localStorage.setItem("token", data.token);
          window.location.href = window.location.origin;
        } else {
          alert(
            "Error: " +
              data.message +
              "\nEssaye une nouvelle fois ou contactez le d√©veloppeur"
          );
        }
      });
  }
</script>
